graph LR
    subgraph "Input Sources"
        API1[ðŸŒ CourseLoop API] --> FILE1
        API2[ðŸŒ Handbook API] --> FILE2
        API2 --> FILE3
        API2 --> FILE4
        API3[ðŸŒ MonPlan API] --> FILE8
        API3 --> FILE9
    end

    subgraph "Generated Files"
        FILE1[ðŸ“„ content_splits.json]
        FILE2[ðŸ“„ raw_units.json]
        FILE3[ðŸ“„ raw_courses.json]
        FILE4[ðŸ“„ raw_aos.json]
        FILE5[ðŸ“„ formatted_units.json]
        FILE6[ðŸ“„ formatted_courses.json]
        FILE7[ðŸ“„ formatted_aos.json]
        FILE8[ðŸ“„ raw_prerequisites.json]
        FILE9[ðŸ“„ raw_prohibitions.json]
        FILE10[ðŸ“„ prohibition_candidates.json]
        FILE11[ðŸ“„ processed_units.json]
        FILE12[ðŸ“„ units_failed.json]
    end

    FILE1 -.Used by all commands.-> FILE2
    FILE1 -.-> FILE3
    FILE1 -.-> FILE4

    FILE2 -->|format units| FILE5
    FILE3 -->|format courses| FILE6
    FILE4 -->|format aos| FILE7

    FILE5 -->|extract prohibitions| FILE10
    FILE10 -->|scrape requisites| FILE9
    FILE1 -->|scrape requisites| FILE8

    FILE5 -->|process| FILE11
    FILE8 -->|process| FILE11
    FILE9 -->|process| FILE11

    FILE2 -.Rate limited units.-> FILE12
    FILE12 -.Retry scraping.-> FILE2

    style API1 fill:#ffccbc
    style API2 fill:#ffccbc
    style API3 fill:#ffccbc
    style FILE11 fill:#4caf50,color:#fff
    style FILE1 fill:#fff9c4